!function(){"use strict";let e=null,t=null,n=!1;const o={levelRadios:null,courseSelect:null,chartCanvas:null,infoBox:null,loadingSpinner:null,errorMessage:null};function a(){o.loadingSpinner&&o.loadingSpinner.classList.remove("d-none"),o.courseSelect&&(o.courseSelect.disabled=!0),o.levelRadios&&o.levelRadios.forEach(e=>e.disabled=!0)}function s(){o.loadingSpinner&&o.loadingSpinner.classList.add("d-none"),o.courseSelect&&(o.courseSelect.disabled=!1),o.levelRadios&&o.levelRadios.forEach(e=>e.disabled=!1)}function r(e){o.errorMessage&&(o.errorMessage.textContent=e,o.errorMessage.classList.remove("d-none"))}async function l(){if(!n){if(n=!0,"undefined"==typeof Chart)return r("A diagram megjelenítéshez szükséges könyvtár nem töltődött be. Kérjük, frissítsd az oldalt!"),void console.error("Chart.js library not loaded");o.levelRadios=document.querySelectorAll('input[name="corvinus-level"]'),o.courseSelect=document.getElementById("corvinus-course-select"),o.chartCanvas=document.getElementById("corvinus-chart"),o.infoBox=document.getElementById("corvinus-info"),o.loadingSpinner=document.getElementById("corvinus-loading"),o.errorMessage=document.getElementById("corvinus-error"),a(),o.errorMessage&&o.errorMessage.classList.add("d-none");try{const t=await fetch("assets/data/corvinus-scholarship.json");if(!t.ok)throw new Error(`HTTP hiba: ${t.status} - ${t.statusText}`);e=await t.json(),c("alapképzés"),o.levelRadios.forEach(e=>{e.addEventListener("change",i)}),o.courseSelect.addEventListener("change",d),s()}catch(e){s(),console.error("Hiba az adatok betöltésekor:",e);let t="Hiba történt az adatok betöltésekor. ";e.message.includes("HTTP")?t+="A szerver nem érhető el. ":e.message.includes("JSON")?t+="Az adatok formátuma hibás. ":e.message.includes("network")?t+="Nincs internetkapcsolat. ":t+=e.message+" ",t+="Kérjük, frissítsd az oldalt vagy próbáld újra később!",r(t)}}}function i(e){c(e.target.value),t&&(t.destroy(),t=null),o.infoBox.classList.add("d-none")}function c(t){const n=new Map;e.periods.forEach(e=>{e.courses.forEach(e=>{e.level===t&&(n.has(e.name)||n.set(e.name,e))})}),o.courseSelect.innerHTML='<option value="">-- Válassz szakot --</option>';Array.from(n.values()).sort((e,t)=>e.name.localeCompare(t.name,"hu")).forEach(e=>{const t=document.createElement("option");t.value=e.name,t.textContent=e.name,o.courseSelect.appendChild(t)})}function d(n){const r=n.target.value;if(!r)return t&&(t.destroy(),t=null),void o.infoBox.classList.add("d-none");a();const l=document.querySelector('input[name="corvinus-level"]:checked').value,i=function(t,n){const o=[],a=[];return e.periods.forEach(e=>{const s=e.courses.find(e=>e.name===t&&e.level===n);if(s){const t=e.period.split("/").slice(0,2).join("/");o.push(t),a.push(s.scholarship_ratio)}}),{labels:o,values:a}}(r,l);requestAnimationFrame(()=>{!function(e,n){t&&t.destroy();const a=o.chartCanvas.getContext("2d");t=new Chart(a,{type:"bar",data:{labels:e.labels,datasets:[{label:"Ösztöndíjas helyek aránya (%)",data:e.values,backgroundColor:"rgba(191, 143, 85, 0.6)",borderColor:"rgba(191, 143, 85, 1)",borderWidth:2,borderRadius:5}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:n,font:{size:16,weight:"bold"}},tooltip:{callbacks:{label:function(e){return e.dataset.label+": "+e.parsed.y+"%"}}}},scales:{y:{beginAtZero:!0,max:100,ticks:{callback:function(e){return e+"%"}},title:{display:!0,text:"Ösztöndíjas helyek aránya (%)"}},x:{title:{display:!0,text:"Tanév"}}}}})}(i,r),o.infoBox.classList.remove("d-none"),s()})}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('[data-bs-toggle="tab"]').forEach(e=>{e.addEventListener("shown.bs.tab",function(e){if("#tab-4"===e.target.getAttribute("href")){const e=document.getElementById("tools-stats");e&&e.checked&&l()}})});document.querySelectorAll('input[name="tools-type"]').forEach(e=>{e.addEventListener("change",function(){"stats"!==this.value||n||requestAnimationFrame(()=>{l()})})})}),window.initCorvinusChart=l}();